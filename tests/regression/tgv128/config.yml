case: tgv_128

mesh:
  global: [128, 128, 128]
  ng: 2
  periodic: [true, true, true] 

time:
  dt: 5.0e-3
  t_end: 20.0
  write_every: { steps: 40 }

io:
  backend: cgns
  path: "@OUT_DIR@"
  precision: native
  async: { enabled: false }
  preflight: { enabled: false }

plugins:
  - lib: libphysics_fluids.so

program:
  key: les
  params:
    # operator spacings (2Ï€ box / 128)
    dx: "0.04908738521234052"
    dy: "0.04908738521234052"
    dz: "0.04908738521234052"

    # TGV initializer extents & amplitude
    Lx: "6.283185307179586"
    Ly: "6.283185307179586"
    Lz: "6.283185307179586"
    U0: "1.0"

    rho: "1"
    nu:  "3.926990816987242e-3" # Re = U0*L/nu => Re = 1600
    Cs:  "0.16"

    scheme: "piso"
    num_corrections: "2"
    time_scheme: "abm3"
    #pred_imp_order: "2"
    div_tol: "1.0e-7"

    advect: "on"
    init: "taylor_green"

fields:
  output: [u, v, w, p]
